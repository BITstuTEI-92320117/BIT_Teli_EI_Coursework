Microsoft (R) Macro Assembler Version 6.11		    10/29/25 23:35:01
tempfile.asm						     Page 1 - 1


 0000				DATAS SEGMENT
				    ; 数据段：无需额外数据，保持为空
 0000				DATAS ENDS

 0000				STACKS SEGMENT
				    ; 堆栈段：保持为空
 0000				STACKS ENDS

 0000				CODES SEGMENT
				    ASSUME CS:CODES,DS:DATAS,SS:STACKS
 0000				start:
				    
 0000  E8 0018			    call input_dec  ; 调用input_dec：读取十进制输入并转为16位二进制数（存于BX）
 0003  E8 000A			    call crlf       ; 输出回车换行
 0006  E8 0035			    call bin_to_hex ; 调用bin_to_hex：将BX中二进制数转为十六进制输出
 0009  E8 0004			    call crlf       ; 输出回车换行
				    
 000C  B4 4C			    mov ah, 4ch     ; DOS功能：程序终止
 000E  CD 21			    int 21h         ; 执行终止调用


				; 回车换行子程序（复用参考程序）：输出回车符(13)和换行符(10)
 0010				crlf proc near
 0010  B4 02			    mov ah, 2       ; DOS功能号：字符输出
 0012  B2 0D			    mov dl, 13      ; 回车符ASCII码
 0014  CD 21			    int 21h
 0016  B2 0A			    mov dl, 10      ; 换行符ASCII码
 0018  CD 21			    int 21h
 001A  C3			    ret
 001B				crlf endp


				; 新增子程序：读取十进制字符（0-9），转换为16位二进制数存于BX
 001B				input_dec proc near
 001B  BB 0000			    mov bx, 0       ; 初始化结果寄存器BX为0（存储转换后的二进制数）
 001E				read_digit:
 001E  B4 01			    mov ah, 1       ; DOS功能号：字符输入
 0020  CD 21			    int 21h         ; 读取键盘输入，字符存于AL
				    
 0022  3C 30			    cmp al, '0'     ; 检查是否为'0'~'9'
 0024  7C 17			    jl input_end    ; 若小于'0'（非数字字符，如回车），结束输入
 0026  3C 39			    cmp al, '9'
 0028  7F 13			    jg input_end    ; 若大于'9'（非数字字符），结束输入
				    
 002A  2C 30			    sub al, 30h     ; 将ASCII码转换为数值（0-9）
 002C  B4 00			    mov ah, 0       ; AH清零，将AL扩展为AX（16位数值）
 002E  50			    push ax         ; 保护AX
 002F  8B C3			    mov ax, bx      ; 将BX移入AX准备相乘
				    
				    ; 计算BX = BX×10 + 当前数值（实现十进制累加）
 0031  B9 000A			    mov cx, 10      ; CX=10，用于乘法
 0034  F7 E1			    mul cx          ; AX = 当前数值×10（临时存储中间结果）
 0036  8B D8			    mov bx, ax      ; 将AX的结果移回BX
 0038  58			    pop ax          ; 恢复AX的值
 0039  03 D8			    add bx, ax      ; BX = 原BX×10 + 当前数值（完成十进制位累加）
				    
 003B  EB E1			    jmp read_digit  ; 继续读取下一位数字
 003D				input_end:
 003D  C3			    ret
 003E				input_dec endp


				; 二进制转十六进制子程序（复用参考程序）：将BX中16位二进制数转为十六进制输出（4位）
 003E				bin_to_hex proc near
 003E  B5 04			    mov ch, 4       ; 16位二进制对应4位十六进制，循环4次
 0040				rotate:
 0040  B1 04			    mov cl, 4       ; 每次处理4位，移位量为4
 0042  D3 C3			    rol bx, cl      ; BX循环左移4位，将待处理的4位移到低4位
 0044  8A C3			    mov al, bl      ; 取BX低8位到AL
 0046  24 0F			    and al, 0fh     ; 保留低4位（屏蔽高4位）
 0048  04 30			    add al, 30h     ; 转换为'0'~'9'的ASCII码（30H~39H）
 004A  3C 3A			    cmp al, 3ah     ; 判断是否为10~15（对应'A'~'F'）
 004C  7C 02			    jl printit      ; 若为0~9，直接输出
 004E  04 07			    add al, 7h      ; 转换为'A'~'F'的ASCII码（3AH+7H=41H即'A'）
 0050				printit:
 0050  8A D0			    mov dl, al      ; 待输出字符存入DL
 0052  B4 02			    mov ah, 2       ; DOS功能号：字符输出
 0054  CD 21			    int 21h         ; 输出当前十六进制位
 0056  FE CD			    dec ch          ; 计数器减1
 0058  75 E6			    jnz rotate      ; 未处理完4位则继续循环
 005A  C3			    ret
 005B				bin_to_hex endp


 005B				CODES ENDS
				    END start       ; 程序结束，入口点为start

Microsoft (R) Macro Assembler Version 6.11		    10/29/25 23:35:01
tempfile.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

CODES  . . . . . . . . . . . . .	16 Bit	 005B	  Para	  Private 
DATAS  . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 
STACKS . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

bin_to_hex . . . . . . . . . . .	P Near	 003E	  CODES	Length= 001D Public
  rotate . . . . . . . . . . . .	L Near	 0040	  CODES	
  printit  . . . . . . . . . . .	L Near	 0050	  CODES	
crlf . . . . . . . . . . . . . .	P Near	 0010	  CODES	Length= 000B Public
input_dec  . . . . . . . . . . .	P Near	 001B	  CODES	Length= 0023 Public
  read_digit . . . . . . . . . .	L Near	 001E	  CODES	
  input_end  . . . . . . . . . .	L Near	 003D	  CODES	


Symbols:

                N a m e                 Type     Value    Attr

start  . . . . . . . . . . . . .	L Near	 0000	  CODES	

	   0 Warnings
	   0 Errors
