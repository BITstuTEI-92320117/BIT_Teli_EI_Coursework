# 对称线天线矩量法仿真代码
## 一、代码概述
本代码基于**矩量法（MoM）** 和**传输线模型（TLM）** 实现对称线天线的辐射特性分析，可计算天线电流分布、输入阻抗、方向性系数、半功率波瓣宽度，绘制二维（E面）和三维辐射方向图，并对比两种模型的求解结果。

## 二、环境依赖
- 运行环境：MATLAB（无需额外工具箱）
- 核心参数：默认频率300MHz，天线半径0.001m，可在主程序中修改

## 三、函数功能说明
| 函数名                | 核心功能                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| `Computational_accuracy(l, a, Z0, k, r, M)` | 分析匹配点个数对计算精度的影响，输出输入电阻/电抗、方向性系数、半功率波瓣宽度的变化曲线 |
| `Direction_map_2D_HPBW(D, l, N, flag)`     | 绘制E面二维方向图，通过线性插值计算半功率波瓣宽度，支持矩量法/传输线模型结果输出 |
| `Direction_map_3D(D, l, N, flag)`          | 绘制三维辐射方向图，对方向性数据归一化处理                                 |
| `DN(A)`                                      | 数据归一化（最大值-最小值缩放），用于方向图绘制和结果对比                   |
| `funcD(E, Z0, flag, l, N)`                  | 基于坡印亭矢量和数值积分计算方向性系数，可选保存结果到Excel文件             |
| `funcE(r0, z, I, a, dl, k, Z0, N, l, M, flag)` | 计算矩量法下远场电场幅值分布，绘制φ=0平面电场分布图，保存幅值数据           |
| `funcE_T(r0, k, l, Z0, M)`                  | 计算传输线模型下远场电场幅值分布，绘制φ=0平面电场分布图                   |
| `I_compare(zb, l, I1, I2, N)`               | 对比矩量法与传输线模型的电流分布，绘制同图对比曲线                         |
| `MoM_I(Z, b, z, l, N, flag)`                | 求解矩量法矩阵方程得到电流分布，可选绘制电流分布图并保存.mat文件           |
| `MoM_Zb(a, k, Z0, N, dl, z)`                | 构建矩量法核心的Z矩阵和b向量，处理源场点重合的奇异点问题                   |
| `MoM_Zin(I, N, l, flag)`                    | 根据馈电点电流计算输入阻抗，可选保存结果到.mat文件                         |
| `TLM_I(l, k)`                                | 基于传输线理论计算电流分布（驻波形式），绘制电流分布图                     |

## 四、运行方式
### 1. 参数配置（主程序）
打开主程序文件，修改核心参数（默认值如下，可按需调整）：
- `l`：天线半长（默认0.25m，半波振子）
- `a`：天线半径（默认0.001m）
- `f`：工作频率（默认3.0e8Hz）
- `N`：矩量法匹配点个数（默认21）
- `flag2`：传输线模型开关（1=启用对比，0=关闭）

### 2. 执行步骤
1. 将所有函数文件与主程序放在同一目录下；
2. 打开MATLAB，切换至该目录；
3. 直接运行主程序（无额外依赖调用）；
4. 查看结果：
   - 实时输出：输入阻抗、方向性系数、半功率波瓣宽度；
   - 图表文件：自动保存电流分布、方向图、精度分析曲线（.png格式）；
   - 数据文件：可选保存电流、阻抗、方向性系数（.mat/.xlsx格式）。

## 五、关键说明
1. 奇异点处理：`MoM_Zb`函数通过泰勒展开解决源场点重合时的积分误差；
2. 结果对比：传输线模型仅适用于远场分析，矩量法在馈电点附近电流分布更精确；
3. 匹配点选择：`N`建议取11~700（过大易导致数值震荡，过小影响精度）；
4. 输出路径：所有结果文件默认保存于当前工作目录，无需手动创建文件夹。