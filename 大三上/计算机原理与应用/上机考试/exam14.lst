Microsoft (R) Macro Assembler Version 6.11		    10/28/25 10:30:26
tempfile.asm						     Page 1 - 1


 0000				DATAS SEGMENT
 0000 64			    ch_num_max db 100      ; 输入缓冲区：最大可输入字符数（100个）
 0001 00			    ch_num_real db ?       ; 实际输入字符数（由DOS 0AH功能调用自动填充）
 0002  0064 [			    cha db 100 dup(?)      ; 存储输入的字符序列（ASCII码形式）
        00
       ]
 0066				DATAS ENDS

 0000				STACKS SEGMENT
				    ; 堆栈段（未定义具体内容，使用默认堆栈）
 0000				STACKS ENDS

 0000				CODES SEGMENT
				    ASSUME CS:CODES,DS:DATAS,SS:STACKS
 0000				START:
 0000  B8 ---- R		    MOV AX,DATAS           ; 初始化数据段寄存器
 0003  8E D8			    MOV DS,AX
 0005  8D 16 0000 R		    lea dx, ch_num_max     ; 取输入缓冲区首地址到dx
 0009  B4 0A			    mov ah, 0ah            ; DOS功能调用：带缓冲区的键盘输入（0AH）
 000B  CD 21			    int 21h                ; 执行输入，输入字符存入cha缓冲区，实际长度存入ch_num_real
				    
				    ; 输入后换行，准备显示统计结果
 000D  B2 0D			    mov dl, 13             ; 回车符ASCII码（13）
 000F  B4 02			    mov ah, 02h            ; DOS功能调用：字符输出（02H）
 0011  CD 21			    int 21h
 0013  B2 0A			    mov dl, 10             ; 换行符ASCII码（10）
 0015  B4 02			    mov ah, 02h
 0017  CD 21			    int 21h
				    
				    ; 第一部分：统计字母（大写A-Z或小写a-z）的数量
 0019  8A 0E 0001 R		    mov cl, byte ptr ch_num_real  ; 循环次数=实际输入字符数（存入cx）
 001D  B5 00			    mov ch, 0                     ; cx高8位清零，cx=实际字符数
 001F  BE 0000			    mov si, 0                     ; 变址寄存器si初始化（指向字符缓冲区起始位置）
 0022  BB 0000			    mov bx, 0                     ; bx用作字母计数器，初始化为0
 0025				L11:
 0025  80 BC 0002 R 41		    cmp cha[si], 41h              ; 比较当前字符与'A'（ASCII 41H）
 002A  7C 16			    jl L13                        ; 若小于'A'，不是字母，跳至L13
 002C  80 BC 0002 R 7A		    cmp cha[si], 7ah              ; 比较当前字符与'z'（ASCII 7ah）
 0031  7F 0F			    jg L13                        ; 若大于'z'，不是字母，跳至L13
 0033  80 BC 0002 R 5A		    cmp cha[si], 5ah              ; 比较当前字符与'Z'（ASCII 5ah）
 0038  7E 07			    jle L12                        ; 若小于等于'Z'，是大写字母，跳至L12（计数）
 003A  80 BC 0002 R 61		    cmp cha[si], 61h              ; 比较当前字符与'a'（ASCII 61h）
 003F  7C 01			    jl L13                        ; 若在'Z'和'a'之间（非字母），跳至L13
 0041				L12:
 0041  43			    inc bx                         ; 字母计数器加1
 0042				L13:
 0042  46			    inc si                         ; 移动到下一个字符
 0043  E2 E0			    loop L11                       ; 循环处理所有字符，直到cx为0
 0045  E8 003F			    call binidec                   ; 调用子程序，将bx中的字母计数以十进制显示
				    
				    ; 第二部分：统计数字（0-9）的数量
 0048  8A 0E 0001 R		    mov cl, byte ptr ch_num_real  ; 重置循环次数=实际输入字符数
 004C  B5 00			    mov ch, 0                     
 004E  BE 0000			    mov si, 0                     ; 重置变址寄存器
 0051  BB 0000			    mov bx, 0                     ; bx用作数字计数器，初始化为0
 0054				L21:
 0054  80 BC 0002 R 30		    cmp cha[si], 30h              ; 比较当前字符与'0'（ASCII 30h）
 0059  7C 08			    jl L22                        ; 若小于'0'，不是数字，跳至L22
 005B  80 BC 0002 R 3A		    cmp cha[si], 3ah              ; 比较当前字符与':'（ASCII 3ah，'9'的下一个字符）
 0060  7D 01			    jge L22                       ; 若大于等于':'，不是数字，跳至L22
 0062  43			    inc bx                         ; 数字计数器加1
 0063				L22:
 0063  46			    inc si                         ; 移动到下一个字符
 0064  E2 EE			    loop L21                       ; 循环处理所有字符
 0066  E8 001E			    call binidec                   ; 调用子程序，将bx中的数字计数以十进制显示
				    
				    ; 第三部分：统计空格（空格符）的数量
 0069  8A 0E 0001 R		    mov cl, byte ptr ch_num_real  ; 重置循环次数=实际输入字符数
 006D  B5 00			    mov ch, 0                     
 006F  BE 0000			    mov si, 0                     ; 重置变址寄存器
 0072  BB 0000			    mov bx, 0                     ; bx用作空格计数器，初始化为0
 0075				L31:
 0075  80 BC 0002 R 20		    cmp cha[si], 20h              ; 比较当前字符与空格（ASCII 20h）
 007A  75 01			    jnz L32                        ; 若不是空格，跳至L32
 007C  43			    inc bx                         ; 空格计数器加1
 007D				L32:
 007D  46			    inc si                         ; 移动到下一个字符
 007E  E2 F5			    loop L31                       ; 循环处理所有字符
 0080  E8 0004			    call binidec                   ; 调用子程序，将bx中的空格计数以十进制显示
				    
				    ; 程序结束，返回DOS
 0083  B4 4C			    MOV AH,4CH
 0085  CD 21			    INT 21H

				; 子程序：将bx中的二进制数转换为十进制并显示（三位数格式）
 0087				binidec proc near
 0087  B9 0064			    mov cx, 100           ; 除数=100（用于提取百位）
 008A  E8 0019			    call dec_div          ; 调用除法子程序，显示百位
 008D  B9 000A			    mov cx, 10            ; 除数=10（用于提取十位）
 0090  E8 0013			    call dec_div          ; 调用除法子程序，显示十位
 0093  B9 0001			    mov cx, 1             ; 除数=1（用于提取个位）
 0096  E8 000D			    call dec_div          ; 调用除法子程序，显示个位
				    ; 显示后换行
 0099  B2 0D			    mov dl, 13
 009B  B4 02			    mov ah, 02h
 009D  CD 21			    int 21h
 009F  B2 0A			    mov dl, 10
 00A1  B4 02			    mov ah, 02h
 00A3  CD 21			    int 21h
 00A5  C3			    ret
 00A6				binidec endp

				; 子程序：除法处理，提取一位十进制数并显示
 00A6				dec_div proc near
 00A6  8B C3			    mov ax, bx            ; 将计数器值（bx）移入ax
 00A8  BA 0000			    mov dx, 0             ; dx清零（扩展被除数为32位：dx:ax）
 00AB  F7 F1			    div cx                ; ax = dx:ax / cx（商），dx = 余数
 00AD  8B DA			    mov bx, dx            ; 保存余数到bx（用于下一次计算）
 00AF  8A D0			    mov dl, al            ; 商（当前位数值）存入dl
 00B1  80 C2 30			    add dl, 30h           ; 转换为ASCII码（0-9对应'0'-'9'）
 00B4  B4 02			    mov ah, 02h           ; 显示该数字
 00B6  CD 21			    int 21h
 00B8  C3			    ret
 00B9				dec_div endp

 00B9				CODES ENDS
				    END START
Microsoft (R) Macro Assembler Version 6.11		    10/28/25 10:30:26
tempfile.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

CODES  . . . . . . . . . . . . .	16 Bit	 00B9	  Para	  Private 
DATAS  . . . . . . . . . . . . .	16 Bit	 0066	  Para	  Private 
STACKS . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

binidec  . . . . . . . . . . . .	P Near	 0087	  CODES	Length= 001F Public
dec_div  . . . . . . . . . . . .	P Near	 00A6	  CODES	Length= 0013 Public


Symbols:

                N a m e                 Type     Value    Attr

L11  . . . . . . . . . . . . . .	L Near	 0025	  CODES	
L12  . . . . . . . . . . . . . .	L Near	 0041	  CODES	
L13  . . . . . . . . . . . . . .	L Near	 0042	  CODES	
L21  . . . . . . . . . . . . . .	L Near	 0054	  CODES	
L22  . . . . . . . . . . . . . .	L Near	 0063	  CODES	
L31  . . . . . . . . . . . . . .	L Near	 0075	  CODES	
L32  . . . . . . . . . . . . . .	L Near	 007D	  CODES	
START  . . . . . . . . . . . . .	L Near	 0000	  CODES	
ch_num_max . . . . . . . . . . .	Byte	 0000	  DATAS	
ch_num_real  . . . . . . . . . .	Byte	 0001	  DATAS	
cha  . . . . . . . . . . . . . .	Byte	 0002	  DATAS	

	   0 Warnings
	   0 Errors
