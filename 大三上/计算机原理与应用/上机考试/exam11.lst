Microsoft (R) Macro Assembler Version 6.11		    10/26/25 20:39:29
tempfile.asm						     Page 1 - 1


 0000				DATAS SEGMENT
				    ; 数据段：本程序无需额外数据，保持为空
 0000				DATAS ENDS

 0000				STACKS SEGMENT
				    ; 堆栈段：保持为空
 0000				STACKS ENDS

 0000				CODES SEGMENT
				    ASSUME CS:CODES,DS:DATAS,SS:STACKS
 0000				start:
 0000  1E			    push ds         ; 保存DS寄存器
 0001  2B C0			    sub ax, ax      ; AX清零
 0003  50			    push ax         ; 压入返回地址0
 0004  E8 0018			    call hexibin    ; 调用hexibin：读取十六进制输入并转为二进制（结果存于BX）
 0007  E8 000A			    call crlf       ; 输出回车换行
 000A  E8 0036			    call bintobin   ; 调用bintobin：将BX中的二进制数（16位）以二进制形式输出
 000D  E8 0004			    call crlf       ; 输出回车换行
 0010  B4 4C			    mov ah, 4ch     ; 程序终止
 0012  CD 21			    int 21h

				; 回车换行子程序（复用原程序）
 0014				crlf proc near
 0014  B4 02			    mov ah, 2       ; DOS功能：字符输出
 0016  B2 0D			    mov dl, 13      ; 回车符ASCII码
 0018  CD 21			    int 21h
 001A  B2 0A			    mov dl, 10      ; 换行符ASCII码
 001C  CD 21			    int 21h
 001E  C3			    ret
 001F				crlf endp

				; 十六进制转二进制子程序（复用原程序）：从键盘读入十六进制字符，转换为16位二进制数存于BX
 001F				hexibin proc near
 001F  BB 0000			    mov bx, 0       ; 初始化结果寄存器BX为0
 0022				newchar:
 0022  B4 01			    mov ah, 1       ; DOS功能：字符输入
 0024  CD 21			    int 21h         ; 读入字符存于AL
 0026  2C 30			    sub al, 30h     ; ASCII码转数值（0-9）
 0028  7C 18			    jl exit         ; 若小于0（非有效字符，如回车），退出转换
 002A  3C 0A			    cmp al, 10      
 002C  7C 0A			    jl add_to       ; 若为0-9，直接累加
 002E  2C 07			    sub al, 07h     ; 转换A-F/a-f为10-15（A的ASCII码41h-30h=11h，再减27h=0Ah）
 0030  3C 0A			    cmp al, 0ah     
 0032  7C 0E			    jl exit         ; 若小于10（非法字符），退出
 0034  3C 10			    cmp al, 10h     
 0036  7D 0A			    jge exit        ; 若大于等于16（非法字符），退出
 0038				add_to:
 0038  B1 04			    mov cl, 4       
 003A  D3 E3			    shl bx, cl      ; BX左移4位（等价于×16），为新数留位置
 003C  B4 00			    mov ah, 0       
 003E  03 D8			    add bx, ax      ; BX = BX×16 + 新输入的数值
 0040  EB E0			    jmp newchar     ; 继续读下一个字符
 0042				exit:
 0042  C3			    ret
 0043				hexibin endp

				; 新增子程序：将BX中的16位二进制数以二进制形式输出（共16位，含前导0）
 0043				bintobin proc near
 0043  8B C3			    mov ax, bx      ; 用AX暂存BX的值（避免修改BX原始数据）
 0045  B9 0010			    mov cx, 16      ; 计数器：需输出16位二进制数
 0048				next_bit:
 0048  D1 E0			    shl ax, 1       ; 左移1位，最高位进入进位标志CF
 004A  B2 30			    mov dl, '0'     ; 默认为字符'0'
 004C  73 02			    jnc output      ; 若CF=0，直接输出'0'
 004E  B2 31			    mov dl, '1'     ; 若CF=1，改为输出'1'
 0050				output:
 0050  50			    push ax
 0051  B4 02			    mov ah, 2       ; DOS功能：字符输出
 0053  CD 21			    int 21h         ; 输出当前位
 0055  58			    pop ax        
 0056  E2 F0			    loop next_bit   ; 循环16次，输出所有位
 0058  C3			    ret
 0059				bintobin endp

 0059				CODES ENDS
				    END start

Microsoft (R) Macro Assembler Version 6.11		    10/26/25 20:39:29
tempfile.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

CODES  . . . . . . . . . . . . .	16 Bit	 0059	  Para	  Private 
DATAS  . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 
STACKS . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

bintobin . . . . . . . . . . . .	P Near	 0043	  CODES	Length= 0016 Public
  next_bit . . . . . . . . . . .	L Near	 0048	  CODES	
  output . . . . . . . . . . . .	L Near	 0050	  CODES	
crlf . . . . . . . . . . . . . .	P Near	 0014	  CODES	Length= 000B Public
hexibin  . . . . . . . . . . . .	P Near	 001F	  CODES	Length= 0024 Public
  newchar  . . . . . . . . . . .	L Near	 0022	  CODES	
  add_to . . . . . . . . . . . .	L Near	 0038	  CODES	
  exit . . . . . . . . . . . . .	L Near	 0042	  CODES	


Symbols:

                N a m e                 Type     Value    Attr

start  . . . . . . . . . . . . .	L Near	 0000	  CODES	

	   0 Warnings
	   0 Errors
