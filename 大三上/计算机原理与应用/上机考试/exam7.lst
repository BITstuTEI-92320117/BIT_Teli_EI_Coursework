Microsoft (R) Macro Assembler Version 6.11		    10/26/25 21:17:20
tempfile.asm						     Page 1 - 1


 0000				DATAS SEGMENT
				    ; 数据段：无需额外数据，保持为空
 0000				DATAS ENDS

 0000				STACKS SEGMENT
				    ; 堆栈段：保持为空
 0000				STACKS ENDS

 0000				CODES SEGMENT
				    ASSUME CS:CODES,DS:DATAS,SS:STACKS
 0000				start:
 0000  1E			    push ds         ; 保存DS寄存器
 0001  2B C0			    sub ax, ax      ; AX清零
 0003  50			    push ax         ; 压入返回地址0（程序结束时返回DOS）
				    
 0004  E8 0018			    call input_dec  ; 调用input_dec：读取十进制输入并转为16位二进制数（存于BX）
 0007  E8 000A			    call crlf       ; 输出回车换行
 000A  E8 0035			    call bintobin   ; 调用bintobin：将BX中的16位二进制数以二进制形式输出
 000D  E8 0004			    call crlf       ; 输出回车换行
				    
 0010  B4 4C			    mov ah, 4ch     ; DOS功能：程序终止
 0012  CD 21			    int 21h         ; 执行终止调用


				; 回车换行子程序（复用两个程序的共同逻辑）：输出回车符和换行符
 0014				crlf proc near
 0014  B4 02			    mov ah, 2       ; DOS功能号：字符输出
 0016  B2 0D			    mov dl, 13      ; 回车符ASCII码
 0018  CD 21			    int 21h
 001A  B2 0A			    mov dl, 10      ; 换行符ASCII码
 001C  CD 21			    int 21h
 001E  C3			    ret
 001F				crlf endp


				; 十进制输入转换子程序（复用第一个程序）：读取十进制字符（0-9），转为16位二进制数存于BX
 001F				input_dec proc near
 001F  BB 0000			    mov bx, 0       ; 初始化结果寄存器BX为0（存储转换后的二进制数）
 0022				read_digit:
 0022  B4 01			    mov ah, 1       ; DOS功能号：字符输入
 0024  CD 21			    int 21h         ; 读取键盘输入，字符存于AL
				    
 0026  3C 30			    cmp al, '0'     ; 检查是否为'0'~'9'
 0028  7C 17			    jl input_end    ; 若小于'0'（非数字字符，如回车），结束输入
 002A  3C 39			    cmp al, '9'
 002C  7F 13			    jg input_end    ; 若大于'9'（非数字字符），结束输入
				    
 002E  2C 30			    sub al, 30h     ; 将ASCII码转换为数值（0-9）
 0030  B4 00			    mov ah, 0       ; AH清零，将AL扩展为AX（16位数值）
 0032  50			    push ax         ; 保护AX（当前数字）
 0033  8B C3			    mov ax, bx      ; 将BX（累计结果）移入AX准备乘法
				    
				    ; 计算BX = BX×10 + 当前数值（实现十进制累加）
 0035  B9 000A			    mov cx, 10      ; CX=10，用于乘法
 0038  F7 E1			    mul cx          ; AX = 累计结果×10
 003A  8B D8			    mov bx, ax      ; 将乘法结果移回BX
 003C  58			    pop ax          ; 恢复AX（当前数字）
 003D  03 D8			    add bx, ax      ; BX = 累计结果×10 + 当前数字（完成累加）
				    
 003F  EB E1			    jmp read_digit  ; 继续读取下一位数字
 0041				input_end:
 0041  C3			    ret
 0042				input_dec endp


				; 二进制输出子程序（复用第二个程序）：将BX中的16位二进制数以二进制形式输出（共16位，含前导0）
 0042				bintobin proc near
 0042  8B C3			    mov ax, bx      ; 用AX暂存BX的值（避免修改原始数据）
 0044  B9 0010			    mov cx, 16      ; 计数器：需输出16位二进制数
 0047				next_bit:
 0047  D1 E0			    shl ax, 1       ; 左移1位，最高位进入进位标志CF
 0049  B2 30			    mov dl, '0'     ; 默认为字符'0'
 004B  73 02			    jnc output      ; 若CF=0（最高位为0），直接输出'0'
 004D  B2 31			    mov dl, '1'     ; 若CF=1（最高位为1），改为输出'1'
 004F				output:
 004F  50			    push ax         ; 保护AX（避免输出中断影响计数器）
 0050  B4 02			    mov ah, 2       ; DOS功能号：字符输出
 0052  CD 21			    int 21h         ; 输出当前位
 0054  58			    pop ax          ; 恢复AX
 0055  E2 F0			    loop next_bit   ; 循环16次，输出所有位
 0057  C3			    ret
 0058				bintobin endp


 0058				CODES ENDS
				    END start       ; 程序结束，入口点为start
Microsoft (R) Macro Assembler Version 6.11		    10/26/25 21:17:20
tempfile.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

CODES  . . . . . . . . . . . . .	16 Bit	 0058	  Para	  Private 
DATAS  . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 
STACKS . . . . . . . . . . . . .	16 Bit	 0000	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

bintobin . . . . . . . . . . . .	P Near	 0042	  CODES	Length= 0016 Public
  next_bit . . . . . . . . . . .	L Near	 0047	  CODES	
  output . . . . . . . . . . . .	L Near	 004F	  CODES	
crlf . . . . . . . . . . . . . .	P Near	 0014	  CODES	Length= 000B Public
input_dec  . . . . . . . . . . .	P Near	 001F	  CODES	Length= 0023 Public
  read_digit . . . . . . . . . .	L Near	 0022	  CODES	
  input_end  . . . . . . . . . .	L Near	 0041	  CODES	


Symbols:

                N a m e                 Type     Value    Attr

start  . . . . . . . . . . . . .	L Near	 0000	  CODES	

	   0 Warnings
	   0 Errors
